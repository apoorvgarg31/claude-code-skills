# Excel Output Templates

Defines the structure and formatting for all Excel outputs generated by the PayApp Auditor.

## MANDATORY Outputs

Every audit produces these Excel files:

1. **Per-vendor Excel** ‚Äî One `.xlsx` per vendor with sheet-per-document-type
2. **Audit Findings Excel** ‚Äî `audit-findings.xlsx` with all findings + summaries
3. **Classification Excel** ‚Äî `classification.xlsx` with document tree
4. **Executive Summary Excel** ‚Äî `executive-summary.xlsx` with project overview

---

## Per-Vendor Excel (`vendors/<vendor-slug>/<vendor-slug>.xlsx`)

**One file per vendor. Each document type gets its own sheet.**

### Sheet: "Invoices"

| Column | Description |
|--------|-------------|
| Invoice Number | Invoice identifier |
| Invoice Date | Date on invoice |
| Due Date | Payment due date |
| PO Number | Purchase order reference |
| Vendor Name (on Invoice) | Name as printed on invoice |
| Bill To | Who the invoice is addressed to |
| Project Name | Project reference |
| Description | Line item descriptions (combined) |
| Subtotal | Before tax |
| Tax | Tax amount |
| Total | Invoice total |
| Source Pages | PDF page numbers |

### Sheet: "Lien Waivers"

| Column | Description |
|--------|-------------|
| Type | Conditional/Unconditional, Progress/Final |
| Through Date | Period covered |
| Amount | Stated amount |
| Signed | Yes/No |
| Notarized | Yes/No |
| Source Pages | PDF page numbers |

### Sheet: "Change Orders"

| Column | Description |
|--------|-------------|
| CO Number | Change order identifier |
| Description | Description of change |
| Amount | Change order amount |
| Status | Approved/Pending/Rejected |
| Date | Date of change order |
| Signatures | Who signed |
| Source Pages | PDF page numbers |

### Sheet: "Certified Payroll"

| Column | Description |
|--------|-------------|
| Pay Period | Week ending date |
| Employee Name | Worker name |
| Classification | Trade/classification |
| Regular Hours | Straight time hours |
| OT Hours | Overtime hours |
| Total Hours | Regular + OT |
| Hourly Rate | Base rate |
| OT Rate | Overtime rate (should be 1.5√ó) |
| Regular Pay | Straight time pay |
| OT Pay | Overtime pay |
| Gross Pay | Total gross wages |
| Deductions | Total deductions |
| Net Pay | Take-home pay |
| Fringe Benefits | Fringe benefit amount |

### Sheet: "Insurance"

| Column | Description |
|--------|-------------|
| Coverage Type | GL, WC, Auto, Umbrella, etc. |
| Insurer | Insurance company name |
| Policy Number | Policy identifier |
| Effective Date | Coverage start |
| Expiration Date | Coverage end |
| Limit | Coverage limit amount |
| Status | Active/Expired/Expiring Soon |

### Sheet: "Line Items" (detailed)

| Column | Description |
|--------|-------------|
| Invoice Number | Parent invoice |
| Description | Line item description |
| Quantity | Quantity |
| Unit | Unit of measure |
| Unit Price | Price per unit |
| Amount | Line total |

---

## Classification Report (`exports/classification.xlsx`)

### Sheet: "Document Classification"

| Column | Description |
|--------|-------------|
| Page Start | First page of document |
| Page End | Last page of document |
| Vendor | Vendor name (or "Prime" for GC docs) |
| Document Type | Invoice, Lien Waiver, Change Order, etc. |
| Document Number | Invoice #, CO #, etc. |
| Confidence | Classification confidence (High/Medium/Low) |
| Notes | Any classifier notes or flags |

### Sheet: "Summary"

| Column | Description |
|--------|-------------|
| Vendor | Vendor name |
| Total Documents | Count of documents |
| Invoices | Count of invoices |
| Lien Waivers | Count of lien waivers |
| Change Orders | Count of change orders |
| Certified Payroll | Count of payroll docs |
| Insurance | Count of COIs |
| Other | Count of other doc types |
| Page Range | First page - Last page |

---

## Audit Findings (`exports/audit-findings.xlsx`)

### Sheet: "All Findings"

| Column | Description |
|--------|-------------|
| # | Finding number |
| Severity | Error / Warning / Info |
| Vendor | Affected vendor |
| Rule # | Rule number (1-30) |
| Category | Rule category (Math, Compliance, Fraud, etc.) |
| Check | Rule name |
| Description | What was found |
| Expected | What was expected |
| Actual | What was found |
| Difference | Numeric difference (if applicable) |
| Pages | Relevant PDF pages |
| Recommendation | Suggested action |

### Sheet: "Summary by Vendor"

| Column | Description |
|--------|-------------|
| Vendor | Vendor name |
| Errors | Count of errors |
| Warnings | Count of warnings |
| Info | Count of info items |
| Total Issues | Total count |
| Total Billed | Sum of invoice amounts |
| Risk Level | High (errors > 2) / Medium / Low |

### Sheet: "Summary by Rule"

| Column | Description |
|--------|-------------|
| Rule # | Rule number |
| Rule | Audit rule name |
| Category | Rule category |
| Severity | Default severity |
| Count | Number of findings |
| Vendors Affected | List of vendor names |

---

## Executive Summary (`exports/executive-summary.xlsx`)

### Sheet: "Executive Summary"

| Row | Content |
|-----|---------|
| Title | "PayApp Audit ‚Äî Executive Summary" |
| Project | Project name |
| GC | General contractor |
| Owner | Project owner |
| Billing Period | Period ending date |
| Total Pages | Number of pages processed |
| Total Documents | Number of documents classified |
| Total Vendors | Number of vendors audited |
| Rules Checked | 30 |
| | |
| **Findings** | |
| Errors | Count |
| Warnings | Count |
| Info | Count |
| Total | Total count |
| | |
| **Top Issues** | |
| 1. | Most critical finding |
| 2. | Second most critical |
| ... | ... |
| | |
| **Risk Assessment** | |
| Overall Risk | High/Medium/Low |
| Payment Recommendation | Approve/Approve with conditions/Hold |

### Sheet: "Vendor Risk Matrix"

| Column | Description |
|--------|-------------|
| Vendor | Vendor name |
| Total Billed | Amount billed this period |
| Errors | Error count |
| Warnings | Warning count |
| Risk Score | Calculated risk score |
| Risk Level | High/Medium/Low |
| Key Issues | Top issues for this vendor |
| Recommendation | Approve/Hold/Review |

---

## Excel Formatting Guidelines

### Header Row
- **Bold** text
- Background: Dark blue (#1F4E79)
- Text color: White
- Font size: 11pt
- Auto-filter enabled

### Data Rows
- Alternating row colors: White / Light gray (#F2F2F2)
- Font size: 10pt
- Text wrap enabled for description columns

### Severity Colors
- üî¥ Error: Red background (#FFC7CE), dark red text (#9C0006)
- üü° Warning: Yellow background (#FFEB9C), dark yellow text (#9C6500)
- ‚ÑπÔ∏è Info: Blue background (#BDD7EE), dark blue text (#1F4E79)

### Currency Columns
- Format: $#,##0.00
- Right-aligned

### Date Columns
- Format: MM/DD/YYYY
- Center-aligned

### Column Widths
- Auto-fit to content with minimum 12 characters
- Description columns: minimum 40 characters
